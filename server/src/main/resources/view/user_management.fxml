<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<BorderPane prefHeight="600.0" prefWidth="800.0" stylesheets="@../css/styles.css" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.vectura.server.controller.UserManagementController" onMouseClicked="#handleClearSelection">

    <top>
        <HBox alignment="CENTER_LEFT" style="-fx-background-color: #1a1a1a; -fx-padding: 15;">
            <Label styleClass="header-label" text="ADMINISTRACIÓN DE USUARIOS" />
        </HBox>
    </top>

    <center>
        <VBox spacing="15.0" style="-fx-background-color: #2b2b2b; -fx-padding: 15;">

            <Label styleClass="section-header" text="LISTADO DE CUENTAS">
                <graphic><FontIcon iconColor="#bdc3c7" iconLiteral="fas-users" /></graphic>
            </Label>

            <TableView fx:id="usersTable" VBox.vgrow="ALWAYS">
                <columns>
                    <TableColumn fx:id="colUser" prefWidth="120.0" text="Usuario" />
                    <TableColumn fx:id="colHome" prefWidth="300.0" text="Directorio Home" />
                    <TableColumn fx:id="colActive" prefWidth="80.0" text="Activo" />
                </columns>
                <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY" /></columnResizePolicy>
            </TableView>

            <VBox spacing="10.0" style="-fx-background-color: #333; -fx-padding: 15; -fx-background-radius: 5; -fx-border-color: #444; -fx-border-radius: 5;">
                <children>
                    <Label style="-fx-font-weight: bold; -fx-text-fill: #ddd;" text="Detalles de Cuenta" />

                    <HBox spacing="10.0">
                        <children>
                            <VBox HBox.hgrow="ALWAYS" spacing="2">
                                <Label text="Usuario:" style="-fx-font-size: 10px; -fx-text-fill: #aaa;"/>
                                <TextField fx:id="txtNewUser" promptText="ej. admin" />
                            </VBox>
                            <VBox HBox.hgrow="ALWAYS" spacing="2">
                                <Label text="Contraseña:" style="-fx-font-size: 10px; -fx-text-fill: #aaa;"/>
                                <PasswordField fx:id="txtNewPass" promptText="••••••" />
                            </VBox>
                        </children>
                    </HBox>

                    <CheckBox fx:id="chkActive" text="Cuenta Activa" selected="true" textFill="#bdc3c7"/>

                    <VBox spacing="2">
                        <Label text="Directorio Home:" style="-fx-font-size: 10px; -fx-text-fill: #aaa;"/>
                        <HBox spacing="5">
                            <TextField fx:id="txtHomeDir" promptText="./sftp_root/usuario" HBox.hgrow="ALWAYS" />
                            <Button text="..." onAction="#handleBrowseDir" style="-fx-min-width: 30px;"/>
                        </HBox>
                    </VBox>

                    <HBox spacing="10.0" alignment="CENTER_RIGHT" style="-fx-padding: 10 0 0 0;">
                        <children>
                            <Button fx:id="btnDelete" mnemonicParsing="false" onAction="#handleDeleteUser" styleClass="button-danger" text="Eliminar">
                                <graphic><FontIcon iconColor="white" iconLiteral="fas-trash" /></graphic>
                            </Button>

                            <Region HBox.hgrow="ALWAYS" />

                            <Button mnemonicParsing="false" onAction="#handleClearSelection" style="-fx-background-color: #7f8c8d;" text="Limpiar">
                                <graphic><FontIcon iconColor="white" iconLiteral="fas-eraser" /></graphic>
                            </Button>

                            <Button fx:id="btnUpdate" mnemonicParsing="false" onAction="#handleUpdateUser" style="-fx-background-color: #2980b9;" text="Actualizar">
                                <graphic><FontIcon iconColor="white" iconLiteral="fas-sync" /></graphic>
                            </Button>
                            <Button fx:id="btnAdd" mnemonicParsing="false" onAction="#handleAddUser" style="-fx-background-color: #27ae60;" text="Crear Nuevo">
                                <graphic><FontIcon iconColor="white" iconLiteral="fas-plus" /></graphic>
                            </Button>
                        </children>
                    </HBox>
                </children>
            </VBox>
        </VBox>
    </center>
</BorderPane>